---
subcategory: "GuardDuty"
layout: aws
page_title: 'AWS: aws_guardduty_publishing_destination'
description: Provides a resource to manage a GuardDuty PublishingDestination
---

# Resource: aws_guardduty_publishing_destination

Provides a resource to manage a GuardDuty PublishingDestination. Requires an existing GuardDuty Detector.

## Example Usage

```python
import constructs as constructs
import cdktf as cdktf
# Provider bindings are generated by running cdktf get.
# See https://cdk.tf/provider-generation for more details.
import ...gen.providers.aws as aws
class MyConvertedCode(cdktf.TerraformStack):
    def __init__(self, scope, name):
        super().__init__(scope, name)
        aws_guardduty_detector_test_gd =
        aws.guardduty_detector.GuarddutyDetector(self, "test_gd",
            enable=True
        )
        aws_s3_bucket_gd_bucket = aws.s3_bucket.S3Bucket(self, "gd_bucket",
            bucket="example",
            force_destroy=True
        )
        aws.s3_bucket_acl.S3BucketAcl(self, "gd_bucket_acl",
            acl="private",
            bucket=cdktf.Token.as_string(aws_s3_bucket_gd_bucket.id)
        )
        data_aws_caller_identity_current =
        aws.data_aws_caller_identity.DataAwsCallerIdentity(self, "current")
        data_aws_iam_policy_document_bucket_pol =
        aws.data_aws_iam_policy_document.DataAwsIamPolicyDocument(self, "bucket_pol",
            statement=[DataAwsIamPolicyDocumentStatement(
                actions=["s3:PutObject"],
                principals=[DataAwsIamPolicyDocumentStatementPrincipals(
                    identifiers=["guardduty.amazonaws.com"],
                    type="Service"
                )
                ],
                resources=["${" + aws_s3_bucket_gd_bucket.arn + "}/*"],
                sid="Allow PutObject"
            ), DataAwsIamPolicyDocumentStatement(
                actions=["s3:GetBucketLocation"],
                principals=[DataAwsIamPolicyDocumentStatementPrincipals(
                    identifiers=["guardduty.amazonaws.com"],
                    type="Service"
                )
                ],
                resources=[cdktf.Token.as_string(aws_s3_bucket_gd_bucket.arn)],
                sid="Allow GetBucketLocation"
            )
            ]
        )
        data_aws_region_current = aws.data_aws_region.DataAwsRegion(self, "current_5")
        # This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.
        data_aws_region_current.override_logical_id("current")
        aws_s3_bucket_policy_gd_bucket_policy =
        aws.s3_bucket_policy.S3BucketPolicy(self, "gd_bucket_policy",
            bucket=cdktf.Token.as_string(aws_s3_bucket_gd_bucket.id),
            policy=cdktf.Token.as_string(data_aws_iam_policy_document_bucket_pol.json)
        )
        data_aws_iam_policy_document_kms_pol =
        aws.data_aws_iam_policy_document.DataAwsIamPolicyDocument(self, "kms_pol",
            statement=[DataAwsIamPolicyDocumentStatement(
                actions=["kms:GenerateDataKey"],
                principals=[DataAwsIamPolicyDocumentStatementPrincipals(
                    identifiers=["guardduty.amazonaws.com"],
                    type="Service"
                )
                ],
                resources=["arn:aws:kms:${" + data_aws_region_current.name + "}:${" + data_aws_caller_identity_current.account_id + "}:key/*"
                ],
                sid="Allow GuardDuty to encrypt findings"
            ), DataAwsIamPolicyDocumentStatement(
                actions=["kms:*"],
                principals=[DataAwsIamPolicyDocumentStatementPrincipals(
                    identifiers=["arn:aws:iam::${" + data_aws_caller_identity_current.account_id + "}:root"
                    ],
                    type="AWS"
                )
                ],
                resources=["arn:aws:kms:${" + data_aws_region_current.name + "}:${" + data_aws_caller_identity_current.account_id + "}:key/*"
                ],
                sid="Allow all users to modify/delete key (test only)"
            )
            ]
        )
        aws_kms_key_gd_key = aws.kms_key.KmsKey(self, "gd_key",
            deletion_window_in_days=7,
            description="Temporary key for AccTest of TF",
            policy=cdktf.Token.as_string(data_aws_iam_policy_document_kms_pol.json)
        )
        aws.guardduty_publishing_destination.GuarddutyPublishingDestination(self, "test",
            depends_on=[aws_s3_bucket_policy_gd_bucket_policy],
            destination_arn=cdktf.Token.as_string(aws_s3_bucket_gd_bucket.arn),
            detector_id=cdktf.Token.as_string(aws_guardduty_detector_test_gd.id),
            kms_key_arn=cdktf.Token.as_string(aws_kms_key_gd_key.arn)
        )
```

~> **Note:** Please do not use this simple example for Bucket-Policy and KMS Key Policy in a production environment. It is much too open for such a use-case. Refer to the AWS documentation here: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_exportfindings.html

## Argument Reference

The following arguments are supported:

* `detector_id` - (Required) The detector ID of the GuardDuty.
* `destination_arn` - (Required) The bucket arn and prefix under which the findings get exported. Bucket-ARN is required, the prefix is optional and will be `AWSLogs/[Account-ID]/GuardDuty/[Region]/` if not provided
* `kms_key_arn` - (Required) The ARN of the KMS key used to encrypt GuardDuty findings. GuardDuty enforces this to be encrypted.
* `destination_type`- (Optional) Currently there is only "S3" available as destination type which is also the default value

~> **Note:** In case of missing permissions (S3 Bucket Policy _or_ KMS Key permissions) the resource will fail to create. If the permissions are changed after resource creation, this can be asked from the AWS API via the "DescribePublishingDestination" call (https://docs.aws.amazon.com/cli/latest/reference/guardduty/describe-publishing-destination.html).

## Attributes Reference

In addition to all arguments above, the following attributes are exported:

* `id` - The ID of the GuardDuty PublishingDestination and the detector ID. Format: `<DetectorID>:<PublishingDestinationID>`

## Import

GuardDuty PublishingDestination can be imported using the master GuardDuty detector ID and PublishingDestinationID, e.g.,

```
$ terraform import aws_guardduty_publishing_destination.test a4b86f26fa42e7e7cf0d1c333ea77777:a4b86f27a0e464e4a7e0516d242f1234
```

<!-- cache-key: cdktf-0.17.0-pre.15 input-97f672d924d3935bf084ac5141380fdc5cbba2253aacbb9ab66b612a86874fa3 -->